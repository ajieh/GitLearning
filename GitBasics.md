# Git基础知识

### 一、Git简介

Git是一款免费开源的分布式版本控制系统，它由Linus创建，拥有庞大的社区支持和活跃的开发者生态，目前广泛应用于软件开发中。Git提供了丰富的命令行工具和图形化界面，包括Git Bash（命令行界面）、Git GUI（图形化界面）以及各种集成开发环境（IDE）中的Git插件。这些工具使开发人员能够轻松地进行版本控制、分支管理和团队协作。

------



### 二、版本控制软件

版本控制软件是一种用于管理和跟踪文件修改历史的工具。它允许多个人或团队在同一个项目上同时进行工作，并记录每个人的修改，以便轻松地进行合并和跟踪更改。

版本控制软件的主要功能包括：

1. 版本控制：它可以跟踪文件的修改历史，记录每个版本的更改内容、作者和时间戳。这使得开发人员可以回滚到以前的版本，恢复文件或了解文件的演变过程。

2. 并发管理：多个人或团队可以在同一个项目上并行工作，版本控制软件可以有效地管理并协调他们的更改，避免冲突和数据丢失。

3. 分支和合并：版本控制软件允许创建分支，即在项目的特定时间点创建一个副本。这使得不同功能或实验性开发可以并行进行，而不会直接影响主要的代码库。分支可以合并回主干代码，保留所有的修改记录。

4. 协作和团队合作：版本控制软件促进了团队协作，允许多个开发人员同时在同一个项目上工作，并且可以轻松地共享和融合彼此的更改。

常见的版本控制软件包括Git、Subversion（SVN）、Mercurial等。这些工具提供了命令行界面和图形化界面，使开发人员能够方便地管理和跟踪文件的版本和更改历史。



### 三、Git基本概念

**Git的“三棵树”：**

- **工作区 (Working Directory):** 可以理解为当前项目的实际文件夹，此区域中的文件并没有被git追踪。
- **暂存区 (Stage)：** 暂存区保存了被Git跟踪的文件的快照或者暂存状态，当工作区项目发生了变更，就提交到暂存区。
- **版本库 (Head):** 它是Git仓库中指向最新提交的指针。每次提交都会生成一个唯一的标识，称为Commit，它包含了当前文件的快照和元数据。

**仓库 (Repository)：** 是Git中用于存储项目所有版本历史记录和相关文件的地方。它是一个包含了项目的所有文件、目录以及每个文件的历史记录的目录。可以分为远程仓库和本地仓库。

**克隆 (Clone)：** 在本地仓库创建一个远程仓库的副本（包括所有的文件、版本历史记录和分支等）。

**推送 (Push)：** 将本地仓库中的改动上传到远程仓库，以便其他开发者可以看到和使用你的修改。

**拉取 (Pull):**  是将远程仓库中的最新代码更新到本地仓库。当其他开发者在远程仓库中提交了一些修改后，你可以使用拉取操作将这些修改同步到你的本地仓库，以便在此基础上继续开发。

**添加 (Add):** 将文件从工作区提交到暂存区。添加操作后，文件的当前状态将被记录在Git的暂存区中，可随后将其提交到本地仓库。

**提交 (Commit)：**提交是指将代码的修改保存到本地仓库，并为这个提交创建一个唯一的SHA标识。这样可以方便地回顾、比较和恢复不同版本之间的代码状态。

**分支 (Branch):**  基于`master`分支（Git的默认分支）创建，每个分支都代表了代码库的一个版本，可以在不同分支间进行切换，并且可以并行地进行开发工作。

**快照 (Snapshot)：** 指的是提交（`commit`）的状态。在每次提交之前，Git会将文件的当前状态（包括添加、修改和删除的文件）保存为一个快照。



### 四、Git使用教程

**1.设置用户名和邮箱**

```
$ git config --global user.name "yourname"
$ git config --global user.email "yourname@email.com"
```

可以用下列命令查看设置信息

```
$ git config --list
```

**2.初始化仓库**

使用`git init`命令可以将当前目录初始化为一个Git仓库。同时会在当前目录生成一个文件夹 `.git `

**注：千万不要删掉.git文件夹！！！**

```
$ git init
```

用下面的命令可以查看当前状态：

```
$ git status
```

**3.将文件添加到暂存区**

如果只是创建了文件，那么该文件不会被Git管理，此时通过`git status`查看，会发现它在`Untracked files`里。因此，要想将文件成为Git仓库的管理对象，要使用`git add`命令将他加入到暂存区中。

添加指定文件到暂存区:

```
$ git add <file>
```

添加当前目录中的所有文件到暂存区：

```
$ git add .
```

添加指定目录中的所有文件到暂存区:

```
$ git add folder/
```

使用通配符添加匹配的文件到暂存区：

```
$ git add *.txt
```

**4.提交修改**

通过`git commit`命令可以把当前暂存区的文件保存到本地仓库, -m参数后是对这个提交的描述信息。

```
$ git commit -m "message"
```

**5.查看提交日志**

通过`git log`命令可以查看仓库中提交的日志。

```
$ git log
```

查看每个提交的简略信息（一行显示一个提交）：

```
$ git log --oneline
```

查看指定文件的修改历史记录：

```
$ git log --<file>
```

查看以图形方式展示的提交历史记录：

```
$ git log --graph
```

**6.查看更改前后的差别**

用`git diff`命令可以查看当前未暂存的文件与最后一次提交（或指定提交）之间的差异。

工作区和暂存区之间的差异，多个文件比对：

```
$ git diff
```

指定文件比对：

```
$ git diff <file>
```

暂存区和本地库之间的差异：

```
$ git diff HEAD <file>
```

显示有多少行发生变化，简洁展示：

```
$ git diff  --stat
```

**7.分支操作**

显示当前分支名

```
$ git branch
```

创建新的分支

```
$ git branch <branch>
```

表示核查工作区相对于版本库修改过的文件

```
$ git checkout
```

切换到对应的分支

```
$ git checkout <branch> 
```

表示以当前分支为基础创建新的分支并切换到该分支

```
$ git checkout -b <branch>
```

切换到上一个分支

```
$ git checkout -
```

删除分支

```
$ git branch -d <branch>
```

**8.合并分支**

将指定分支合并到当前分支

```
$ git merge <branch>
```

添加`--no-ff`参数，意味着禁止快进式合并（即默认的-ff合并，当要合并的分支与目标分支的历史之间没有分叉时，合并的时候Git只需移动分支指针，将它们指向目标分支的最新提交，而无需创建新的合并提交。这样的合并没有明确的合并历史，很难追踪各个分支的合并点）,Git会强制创建一个新的合并提交, 这能保留合并前分支的历史信息。

```
$ git merge --no-ff <branch>
```

`--squash`参数将要合并的分支的提交记录压缩成一个单独的提交，并将这个合并提交添加到当前分支，从而保持提交历史的简洁性。

```
$ git merge --squash <branch>
```

**9.合并冲突**

合并冲突（`Merge Conflict`）是在合并分支时出现的一种情况，当Git无法自动合并两个不同的提交时，就会发生合并冲突。

合并冲突通常发生在以下情况下：

1. 当两个分支对同一个文件的同一部分进行了修改。
2. 当一个分支删除了一个文件，而另一个分支修改了该文件。
3. 当两个分支同时添加了具有相同名称的新文件。

**解决方法：**

1. 用`git status`命令，查看哪些文件存在合并冲突。
2. 打开冲突文件，查看冲突的具体位置。Git会在冲突的位置使用特殊的标记来标识冲突的代码。通常，冲突的修改会被标记为 `<<<<<<< HEAD` 和 `>>>>>>>`。
3. 根据需要编辑冲突的部分，可以手动选择使用哪个分支的更改，或者进行其他修改。删除不需要的标记和分隔符。
4. 保存文件后，运行 `git add <file_name>` 将解决冲突后的文件标记为已解决。
5. 如果还有其他存在冲突的文件，重复步骤 2 - 4。
6. 运行 `git commit` 完成提交并解决合并冲突。

**10.回溯历史**

用git reset命令可以回退到指定哈希值对应的时间点上，通常有三种参数。

`--soft`参数。将当前分支指针移动到指定的提交，但保留暂存区和工作区的所有修改

```
$ git reset --soft <commit>
```

`--mixed`参数，也是该命令的默认参数。将当前分支指针移动到指定的提交，仅保留工作区的修改，并重置暂存区为指定提交的状态。

```
$ git reset --mixed <commit>
```

`--hard`参数，将当前分支指针移动到指定的提交，并重置暂存区和工作区为指定提交的状态。这会彻底删除之前的更改，使得工作区中的文件与指定提交一致。

```
$ git reset --hard <commit>
```

**11.压缩历史**

`git rebase` 可以将一系列提交应用到其他分支上，使提交历史显得更加线性和整洁。

将当前分支的提交添加到指定分支的最后，例如，如果你当前在分支 `feature` 上，想要将 `feature` 分支的提交添加到 `master` 分支的最后

```
$ git rebase master
```

合并多个提交为一个提交，其中`<num>` 表示要合并的提交数量，例如`HEAD~3`就是将最近的3个提交合并为一个提交。

```
$ git rebase -i HEAD~<num>
```

**12.远程仓库**

`git remote add` 命令用于将远程仓库添加到你的本地仓库中。你可以通过该命令给远程仓库指定一个简单易记的名字，并将其与远程仓库的 URL 关联起来。

```
$ git remote add <remote-name> <remote-url>
```

添加完成后，你可以通过 `git remote -v` 命令来验证是否成功添加了远程仓库：

```git remote -v
$ git remote -v
```

通过`git clone` 命令用于将远程仓库的所有代码克隆到本地。`<remote-url>` 是远程仓库的 URL，可以是 HTTP(S) 或 SSH 协议的 URL。`<local-directory>` 是本地目录的路径，用于指定将远程仓库克隆到本地的位置。

```
$ git clone <remote-url> <local-directory>
```

如果想把本地主分支推送到远程仓库，可以使用下面命令

```
$ git push <remote-name> <branch-name>
```

通过`git pull` 命令可以从远程仓库获取最新的提交，并将其合并到当前分支中。它的实际操作是执行了两个命令：`git fetch` 和 `git merge`。命令的语法如下：

```
$ git pull <remote-name> <branch-name>
```

